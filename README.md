# Keylogger with Email Notification and Shutdown Detection

This is a Python-based **Keylogger** program that captures all keyboard input, logs it in a text file, and sends the captured keystrokes via email. The program also detects system shutdown events and sends an email before the shutdown occurs. It stops running gracefully when the **Esc** key is pressed.

---

## Features:
- **Keystroke Logging**: Logs all keyboard input, including special keys like space, enter, shift, ctrl, and others.
- **Email Notification**: Sends the captured log file as an email to a specified recipient (default is the user's email).
- **Shutdown Detection**: Detects when the system is shutting down and sends the email with the captured keystrokes before shutdown.
- **Graceful Shutdown**: Exits the program gracefully when the **Esc** key is pressed.
- **Line Splitting**: If a single line in the log exceeds 150 characters, it automatically breaks the line for better readability.

---

## Requirements:
1. Python 3.x
2. Required Libraries:
   - `pynput`: For capturing keyboard events.
   - `psutil`: For detecting system shutdown events.
   - `smtplib`: For sending emails using SMTP.
   - `email`: For email formatting and attachment handling.

You can install the required libraries with the following command:

```bash
pip install pynput psutil
```

---

## Setup Instructions:

1. **SMTP Configuration**:
   - For Gmail, you must allow "Less secure apps" or generate an **App Password** if you have two-factor authentication (2FA) enabled.
   - Update the script with your **email address** and **password** in the `email` and `password` variables.

2. **Running the Program**:
   - Clone or download this repository.
   - Open the terminal (or command prompt) and navigate to the folder containing the script.
   - Run the script with the following command:
   
   ```bash
   python keylogger.py
   ```

   The program will start listening for keystrokes, and it will send the log to your email when either:
   - The **Esc** key is pressed.
   - The system is shutting down.

3. **Converting the Script to `.exe` for Windows**:
   - To run this program as a standalone executable on Windows, you can convert the Python script into a `.exe` file using **PyInstaller**.
   
   - Install PyInstaller:
     ```bash
     pip install pyinstaller
     ```

   - Convert the script to `.exe`:
     ```bash
     pyinstaller --onefile --noconsole keylogger.py
     ```

   - After running the above command, you will find the `.exe` file in the `dist` folder inside your project directory. The `--noconsole` flag ensures that the console window will not appear when the program is run.

4. **Adding the Program to Startup on Windows**:
   - To ensure the program runs automatically when the system starts:
     1. Press `Win + R`, type `shell:startup`, and hit Enter to open the startup folder.
     2. Copy the `.exe` file that was generated by PyInstaller into this folder.
     3. The program will now run automatically each time the computer is started.

---

## How It Works:
1. **Keystroke Capture**: The `on_press` method listens for all keypress events and writes the keys to a `log.txt` file.
2. **Email Sending**: The `send_email` method sends the contents of `log.txt` as an email body. It attaches the log file and sends it via SMTP.
3. **Shutdown Detection**: The `detect_shutdown` method checks for shutdown events by detecting `shutdown.exe` or `poweroff.exe` processes. It sends the captured keystrokes via email before the shutdown is completed.
4. **Graceful Exit**: The program exits when the **Esc** key is pressed, ensuring the program stops logging and sends the final log.

---

## Warning:
This is a **Keylogger** program designed for **educational purposes** only. It is crucial to understand the privacy and ethical implications of running this software. Only use it on devices you own or have explicit permission to test. Unauthorized use of keyloggers is illegal and unethical.

---
